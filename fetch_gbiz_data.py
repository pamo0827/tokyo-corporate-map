
import mysql.connector
from db_utils import get_db_connection, create_database_and_tables
from exceptions import DatabaseError, logger

def insert_sample_data():
    """サンプルデータをMySQLに挿入する"""
    try:
        create_database_and_tables()
        
        conn = get_db_connection()
        if not conn:
            return

        sample_companies = [
            # 大手通信・携帯キャリア
            ("株式会社NTTドコモ", "東京都千代田区永田町2-11-1", 35.681236, 139.767125, "9010001029001"),
            ("ソフトバンク株式会社", "東京都港区東新橋1-9-1", 35.666197, 139.758751, "9010001048749"),
            ("KDDI株式会社", "東京都千代田区飯田橋3-10-10", 35.702763, 139.744721, "9011001029928"),
            ("日本電信電話株式会社", "東京都千代田区大手町1-5-1", 35.686777, 139.765739, "9010001017166"),
            
            # 大手EC・インターネットサービス
            ("楽天グループ株式会社", "東京都世田谷区玉川1-14-1", 35.611347, 139.634991, "9010701021641"),
            ("株式会社メルカリ", "東京都港区六本木6-10-1", 35.664062, 139.731537, "9010401044048"),
            ("アマゾンジャパン合同会社", "東京都目黒区下目黒1-8-1", 35.633036, 139.715802, "0104010075963"),
            ("ヤフー株式会社", "東京都千代田区紀尾井町1-3", 35.679582, 139.736932, "2010001053280"),
            ("株式会社ZOZO", "千葉県千葉市美浜区中瀬2-6-1", 35.647747, 140.046875, "8040001039083"),
            
            # 大手IT・ソフトウェア
            ("株式会社サイバーエージェント", "東京都渋谷区宇田川町40-1", 35.661777, 139.697047, "2010401039783"),
            ("GMOインターネット株式会社", "東京都渋谷区桜丘町26-1", 35.656073, 139.698303, "1010401043248"),
            ("株式会社ディー・エヌ・エー", "東京都渋谷区渋谷2-21-1", 35.659507, 139.704051, "3010401048056"),
            ("グリー株式会社", "東京都港区六本木6-10-1", 35.664062, 139.731537, "6010401046652"),
            ("エヌ・ティ・ティ・コミュニケーションズ株式会社", "東京都千代田区内幸町1-1-6", 35.672855, 139.758137, "9010001068094"),
            
            # クラウド・インフラ
            ("日本マイクロソフト株式会社", "東京都港区港南2-16-3", 35.629315, 139.740982, "4010401016638"),
            ("グーグル・クラウド・ジャパン合同会社", "東京都港区六本木6-10-1", 35.664062, 139.731537, "0104010082374"),
            ("セールスフォース・ジャパン株式会社", "東京都千代田区丸の内2-7-2", 35.682839, 139.762077, "3010001089848"),
            ("日本オラクル株式会社", "東京都港区北青山2-5-8", 35.670776, 139.721512, "8010001041669"),
            ("アマゾン ウェブ サービス ジャパン合同会社", "東京都目黒区下目黒1-8-1", 35.633036, 139.715802, "0104010090234"),
            
            # ゲーム・エンターテイメント
            ("任天堂株式会社", "京都府京都市南区上鳥羽鉾立町11-1", 34.968167, 135.751472, "9130001013023"),
            ("株式会社ソニー・インタラクティブエンタテインメント", "東京都港区港南1-7-1", 35.627956, 139.739532, "9010401022844"),
            ("株式会社カプコン", "大阪府大阪市中央区内平野町3-1-3", 34.674692, 135.515564, "5120001025854"),
            ("株式会社スクウェア・エニックス", "東京都新宿区新宿6-27-30", 35.693761, 139.719238, "1010001022957"),
            ("株式会社コナミホールディングス", "東京都港区赤坂9-7-2", 35.670203, 139.731844, "3010401054174"),
            
            # フィンテック・金融IT
            ("株式会社マネーフォワード", "東京都港区芝浦3-1-21", 35.641782, 139.747982, "6010401127054"),
            ("freee株式会社", "東京都品川区西五反田2-8-1", 35.625906, 139.725235, "8010701030007"),
            ("株式会社ペイペイ", "東京都千代田区紀尾井町1-3", 35.679582, 139.736932, "9010001188514"),
            ("株式会社Liquid", "東京都千代田区永田町2-11-1", 35.681236, 139.767125, "5010001197851"),
            
            # AI・機械学習
            ("株式会社Preferred Networks", "東京都千代田区大手町1-6-1", 35.686047, 139.766084, "7010001174799"),
            ("株式会社ABEJA", "東京都港区芝公園1-2-10", 35.655721, 139.749375, "5010401132522"),
            ("レコメンド株式会社", "東京都渋谷区恵比寿1-19-19", 35.647382, 139.710388, "4011001069072"),
            
            # セキュリティ
            ("トレンドマイクロ株式会社", "東京都渋谷区代々木2-1-1", 35.687443, 139.700478, "1011001016642"),
            ("株式会社ラック", "東京都千代田区平河町2-16-1", 35.682384, 139.741608, "8010001052607"),
            ("サイボウズ株式会社", "東京都中央区日本橋2-7-1", 35.682045, 139.774049, "7010401021291"),
            
            # 大手SI・ITサービス
            ("富士通株式会社", "東京都港区東新橋1-5-2", 35.666034, 139.758693, "1020001071491"),
            ("日本電気株式会社", "東京都港区芝5-7-1", 35.652832, 139.747925, "1010001067980"),
            ("株式会社日立製作所", "東京都千代田区丸の内1-6-6", 35.682205, 139.765236, "7010001008844"),
            ("東芝デジタルソリューションズ株式会社", "神奈川県川崎市幸区堀川町72-34", 35.551728, 139.697356, "9020001090695"),
            ("日本IBM株式会社", "東京都中央区日本橋箱崎町19-21", 35.687542, 139.785629, "1010001008900"),
            ("株式会社野村総合研究所", "東京都横浜市西区みなとみらい4-4-3", 35.462963, 139.626465, "2010001054036"),
            ("SCSK株式会社", "東京都江東区豊洲3-2-20", 35.654446, 139.790955, "6010001083726"),
            ("伊藤忠テクノソリューションズ株式会社", "東京都千代田区霞が関3-2-5", 35.674286, 139.748383, "9010001028838"),
            ("株式会社電通デジタル", "東京都港区東新橋1-8-1", 35.666282, 139.758331, "8010001183701"),
            ("アクセンチュア株式会社", "東京都港区赤坂1-8-1", 35.674042, 139.737152, "3010001074831"),
            
            # データ・アナリティクス
            ("株式会社ブレインパッド", "東京都港区白金台3-2-10", 35.637218, 139.723602, "2010401053685"),
            ("株式会社ユーザベース", "東京都港区虎ノ門1-3-1", 35.671833, 139.750862, "8010401051935"),
            ("Sansan株式会社", "東京都渋谷区神宮前5-52-2", 35.666214, 139.704338, "3011001039900"),
            ("株式会社Treasure Data", "東京都中央区銀座7-13-6", 35.670216, 139.765625, "4010001142175"),
            
            # モビリティ・IoT
            ("株式会社DeNA", "東京都渋谷区渋谷2-21-1", 35.659507, 139.704051, "3010401048056"),
            ("ソニーセミコンダクタソリューションズ株式会社", "神奈川県厚木市旭町4-14-1", 35.438194, 139.359583, "8021001042474"),
            ("パナソニック コネクト株式会社", "東京都中央区銀座8-21-1", 35.670832, 139.766667, "5010001197752"),
            ("三菱電機株式会社", "東京都千代田区丸の内2-7-3", 35.682839, 139.762077, "1010001008772"),
            
            # 教育・Edtech
            ("株式会社ベネッセホールディングス", "岡山県岡山市北区南方3-7-17", 34.666389, 133.924167, "7260001013611"),
            ("株式会社リクルート", "東京都千代田区丸の内1-9-2", 35.683056, 139.765000, "4010001067359"),
            ("株式会社スタディプラス", "東京都千代田区神田駿河台2-5-12", 35.697044, 139.767278, "4010001142951"),
            
            # メディア・広告テック
            ("株式会社電通", "東京都港区東新橋1-8-1", 35.666282, 139.758331, "9010001032510"),
            ("株式会社博報堂DYホールディングス", "東京都港区赤坂5-3-1", 35.673056, 139.738889, "8010001047286"),
            ("株式会社オプト", "東京都千代田区四番町6", 35.685833, 139.737500, "4010001018659"),
            ("株式会社アドウェイズ", "東京都新宿区西新宿8-17-1", 35.693611, 139.689722, "7011001039071"),
            
            # HR・人材テック
            ("株式会社ビズリーチ", "東京都渋谷区渋谷2-15-1", 35.659722, 139.704167, "2010401067346"),
            ("株式会社リクルートキャリア", "東京都千代田区丸の内1-9-2", 35.683056, 139.765000, "6010001088721"),
            ("エン・ジャパン株式会社", "東京都新宿区西新宿6-5-1", 35.691389, 139.691667, "7011001015732"),
            
            # ヘルスケア・メドテック
            ("株式会社メドレー", "東京都港区六本木3-2-1", 35.664167, 139.733333, "3010401079912"),
            ("株式会社エムスリー", "東京都港区赤坂9-7-1", 35.670833, 139.731944, "7010401021358"),
            ("株式会社カケハシ", "東京都港区三田1-4-1", 35.647222, 139.747778, "9010401089445"),
            
            # 不動産テック
            ("株式会社GA technologies", "東京都港区六本木3-2-1", 35.664167, 139.733333, "6010401055678"),
            ("株式会社スペースマーケット", "東京都渋谷区宇田川町2-1", 35.661111, 139.698333, "8011001062752"),
            ("株式会社イタンジ", "東京都港区赤坂3-5-2", 35.674167, 139.737500, "2010401075372"),
            
            # ロジスティクス・物流テック
            ("佐川急便株式会社", "京都府京都市南区上鳥羽角田町68", 34.968333, 135.751944, "2130001014601"),
            ("ヤマト運輸株式会社", "東京都中央区銀座2-16-10", 35.674722, 139.765278, "1010001008669"),
            ("株式会社Hacobu", "東京都港区白金台3-2-10", 35.637218, 139.723602, "8010401082582"),
            
            # 農業・食品テック
            ("株式会社オイシックス・ラ・大地", "東京都品川区大崎1-11-2", 35.620833, 139.728333, "4010701025379"),
            ("株式会社プランテックス", "東京都千代田区九段北1-13-5", 35.695278, 139.752778, "2010001174924"),
            
            # 建設・不動産テック
            ("株式会社フォトラクション", "東京都千代田区九段北1-13-5", 35.695278, 139.752778, "5010001193602"),
            ("株式会社コンストラクション・EC", "東京都港区赤坂3-2-12", 35.674167, 139.738889, "4010401084829"),
            
            # スタートアップ・新興企業
            ("株式会社SmartHR", "東京都港区六本木3-2-1", 35.664167, 139.733333, "2010401139946"),
            ("株式会社チームラボ", "東京都千代田区神田小川町2-12", 35.696111, 139.765556, "9010001056705"),
            ("株式会社LayerX", "東京都中央区日本橋2-7-1", 35.682045, 139.774049, "1010001194033"),
            ("株式会社アルファドライブ", "東京都港区六本木3-2-1", 35.664167, 139.733333, "6010401086885"),
            ("株式会社10X", "東京都港区六本木3-2-1", 35.664167, 139.733333, "8010401083084"),
            ("株式会社Mobility Technologies", "東京都港区六本木3-2-1", 35.664167, 139.733333, "7010401087394"),
            ("株式会社ココナラ", "東京都渋谷区桜丘町20-1", 35.656944, 139.698611, "4011001069270"),
            ("株式会社クラウドワークス", "東京都渋谷区恵比寿4-20-3", 35.646944, 139.709722, "2011001058847"),
            ("株式会社ランサーズ", "東京都渋谷区渋谷3-10-13", 35.658333, 139.703056, "1010401088337"),
            ("株式会社BASE", "東京都港区六本木3-2-1", 35.664167, 139.733333, "5010401117747"),
            ("株式会社ウルシステムズ", "東京都港区港南2-15-3", 35.628056, 139.740278, "8010401040357"),
            ("株式会社フリー", "東京都品川区西五反田2-8-1", 35.625906, 139.725235, "8010701030007"),
            ("株式会社アカツキ", "東京都港区赤坂3-5-2", 35.674167, 139.737500, "1010401073572"),
            ("株式会社イグニス", "東京都渋谷区恵比寿4-3-6", 35.646667, 139.709444, "8011001051599"),
            ("株式会社ガンホー・オンライン・エンターテイメント", "東京都千代田区丸の内1-11-1", 35.682500, 139.767500, "5010001063887"),
            ("株式会社コロプラ", "東京都渋谷区恵比寿4-20-3", 35.646944, 139.709722, "8011001041715"),
            ("株式会社mixi", "東京都渋谷区桜丘町20-1", 35.656944, 139.698611, "9011001039928"),
            ("株式会社リブセンス", "東京都品川区上大崎2-25-2", 35.622500, 139.728889, "4010701025544"),
            ("株式会社ドリコム", "東京都目黒区青葉台3-6-28", 35.646944, 139.703056, "9013301017447"),
            ("株式会社トレタ", "東京都渋谷区恵比寿1-18-18", 35.647222, 139.710278, "4011001058449"),
            ("株式会社Speee", "東京都港区六本木4-1-4", 35.663889, 139.731944, "1010401073589"),
            ("株式会社オープンハウス", "東京都千代田区丸の内3-4-1", 35.681944, 139.762778, "7010001088049"),
            ("株式会社ネクシィーズ", "東京都渋谷区南平台町16-17", 35.659722, 139.698056, "4011001036561"),
            ("株式会社イノベーション", "東京都港区赤坂1-12-32", 35.673889, 139.738056, "9010401053604"),
            ("株式会社エス・エム・エス", "東京都港区芝公園2-11-1", 35.655278, 139.748611, "6010401044621"),
            ("株式会社じげん", "東京都港区虎ノ門3-4-8", 35.668889, 139.748333, "4010401039859"),
            ("株式会社イード", "東京都新宿区西新宿2-6-1", 35.691667, 139.692500, "4011101044423"),
            ("株式会社ワークスアプリケーションズ", "東京都港区赤坂1-12-32", 35.673889, 139.738056, "4010401022092"),
            ("株式会社インフォマート", "東京都港区赤坂3-5-2", 35.674167, 139.737500, "3010401048031"),
            ("株式会社クリーク・アンド・リバー社", "東京都千代田区麹町2-10-9", 35.684444, 139.742222, "5010001047456")
        ]

        with conn.cursor() as cursor:
            add_company = (
                "INSERT INTO companies "
                "(name, address, latitude, longitude, corporate_number) "
                "VALUES (%s, %s, %s, %s, %s) "
                "ON DUPLICATE KEY UPDATE "
                "name=VALUES(name), address=VALUES(address), "
                "latitude=VALUES(latitude), longitude=VALUES(longitude)"
            )
            for company_data in sample_companies:
                cursor.execute(add_company, company_data)

        conn.commit()
        logger.info("Sample data inserted/updated in MySQL")

    except mysql.connector.Error as err:
        raise DatabaseError("Failed to insert sample data", err)
    finally:
        if conn:
            conn.close()


if __name__ == "__main__":
    logger.info("Using sample data only (API disabled)")
    insert_sample_data()
    logger.info("Data insertion completed")
